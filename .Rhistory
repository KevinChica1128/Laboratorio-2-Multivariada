#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
PCA.results$var$contrib #contribuciones
#f) Descriptivas
summary(provincias)
X11()
boxplot(provincias)
boxplot(provincias[,-1])
X11()
boxplot(provincias[,-1])
plotellipses(PCA.results)
PCA.results=PCA(provincias[,-1])
PCA.results
plotellipses(PCA.results)
plotellipses(PCA.results$var$cor)
x11()
plotellipses(PCA.results$var$cor)
#base de datos
provincias=read.table("clipboard",header=T)
View(provincias)
PCA.results=PCA(provincias)
x11()
PCA.results=PCA(provincias)
PCA.results$eig[2,3]#porcentaje de varianza explicada por los dos primeros ejes
X11()
barplot(PCA.results$eig[,2])#grafico del porcentaje explicado
PCA.results$eig
X11()
barplot(PCA.results$eig[,2])#grafico del porcentaje explicado
X11()
plot(PCA.results)#grafico de los individuos dos primeras dimenciones
x11()
plotellipses(PCA.results)
#3) representacion simultanea
library(factoextra)
plotellipses(PCA.results)
x11()
fviz_pca_biplot(PCA.results)
#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
PCA.results$var$contrib #contribuciones
#f) Descriptivas
summary(provincias)
X11()
boxplot(provincias)
plotellipses(PCA.results)
plotellipses(PCA.results)
x11()
plot(PCA.results,choix="var")
#f) Descriptivas
summary(provincias)
View(provincias)
sd(provincias)
sd(provincias$X1)
sd(provincias$X2)
sd(provincias$X3)
sd(provincias$X4)
sd(provincias$X5)
sd(provincias$X6)
sd(provincias$X7)
sd(provincias$X8)
sd(provincias$X9)
X11()
boxplot(provincias)
X11()
boxplot(provincias,xlab='Variable',ylab='Presupuesto Familiar')
X11()
boxplot(provincias,xlab='Variable',ylab='Presupuesto Familiar',main='Gráfico de cajas')
X11()
boxplot(provincias,xlab='Variable',ylab='Presupuesto Familiar',main='Gráfico de cajas del presupuesto familiar por variable')
cor(provincias)
#Matriz de correlaciones
cor(provincias)
#*****Lab 2
#funciones
#Porcentaje de incercia
library("ade4")
library("FactoMineR")
X11()
plot(PCA.results)#grafico de los individuos dos primeras dimenciones
x11()
plot(PCA.results,choix="var")
#3) representacion simultanea
library(factoextra)
x11()
fviz_pca_biplot(PCA.results)
#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
PCA.results$var$contrib #contribuciones
#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
2.226187e-01
3.552639e-06
4.784868e-05
PCA.results$var$contrib #contribuciones
7.518112e+00
6.156476e-03
PCA.results$eig[2,3]#porcentaje de varianza explicada por los dos primeros ejes
PCA.results$eig
X11()
barplot(PCA.results$eig[,2])#grafico del porcentaje explicado
X11()
barplot(PCA.results$eig[,2],ylim = c(0,80))#grafico del porcentaje explicado
X11()
barplot(PCA.results$eig[,2],ylim = c(0,70))#grafico del porcentaje explicado
X11()
barplot(PCA.results$eig[,2],ylim = c(0,70),xlab='Componentes',ylab = '% de varianza explicado')#grafico del porcentaje explicado
X11()
barplot(PCA.results$eig[,2],ylim = c(0,70),xlab='Componentes',
main='Gráfico de barras del porcentaje de inercia explicada por cada componente',ylab = '% de varianza explicado')#grafico del porcentaje explicado
PCA.results=PCA(provincias)
#*****Lab 2
#funciones
#Porcentaje de incercia
library("ade4")
library("FactoMineR")
PCA.results=PCA(provincias)
PCA.results
PCA.results$ind
View(provincias)
#Matriz de correlaciones
cor(provincias)
#base de datos
provincias=read.table("clipboard",header=T)
#base de datos
provincias=read.table("clipboard",header=T)
View(provincias)
PCA.results=PCA(provincias[,-1])
#*****Lab 2
#funciones
#Porcentaje de incercia
library("ade4")
library("FactoMineR")
x11()
PCA.results=PCA(provincias[,-1])
PCA.results$eig[2,3]#porcentaje de varianza explicada por los dos primeros ejes
X11()
barplot(PCA.results$eig[,2],ylim = c(0,70),xlab='Componentes',
main='Gráfico de barras del porcentaje de inercia explicada por cada componente',ylab = '% de varianza explicado')#grafico del porcentaje explicado
X11()
plot(PCA.results)#grafico de los individuos dos primeras dimenciones
x11()
plot(PCA.results,choix="var")
#3) representacion simultanea
library(factoextra)
x11()
fviz_pca_biplot(PCA.results)
#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
PCA.results$var$contrib #contribuciones
#f) Descriptivas
summary(provincias)
X11()
boxplot(provincias,xlab='Variable',ylab='Presupuesto Familiar',main='Gráfico de cajas del presupuesto familiar por variable')
boxplot(provincias[,-1],xlab='Variable',ylab='Presupuesto Familiar',main='Gráfico de cajas del presupuesto familiar por variable')
X11()
boxplot(provincias[,-1],xlab='Variable',ylab='Presupuesto Familiar',main='Gráfico de cajas del presupuesto familiar por variable')
#f) Descriptivas
summary(provincias[,-1])
#Matriz de correlaciones
cor(provincias)
#Matriz de correlaciones
cor(provincias[,-1])
x11()
fviz_pca_biplot(PCA.results)
#4)contribuciones y cosenos cuadrados
PCA.results$var$cos2 #cosenos cuadrados
PCA.results$var$contrib #contribuciones
#ACPEM (ACP iterativo) con función de R
library(missMDA)
nb5 <- estim_ncpPCA(importaciones_1,ncp.max=6,method = 'EM')
estim_ncpPCA
x11()
fviz_pca_biplot(PCA.results)
x11()
fviz_pca_biplot(PCA.results)
PCA.results$var$coord
#Indice
I=PCA.results$var$coord[,1]%*%t(provincias[,-1])
I
PCA.results$var$coord
PCA.results
PCA.results$var$contrib
sqrt(PCA.results$var$contrib[,1])/9
eigen(cor(provincias[,-1]))
sqrt(PCA.results$var$contrib[,1])/9
sqrt(PCA.results$var$contrib[,1])/10
#Indice
I=PCA.results$var$coord[,1]%*%t(provincias[,-1])
I
#Relaciones de transición
N<-diag(1/51,nrow = 51)
N
#Relaciones de transición
N<-diag(1/51,nrow = 51,ncol = 51)
N
N1.2<-sqrt(N)
N1.2
#Construción de Z
sd2 <- function (x) {
sqrt(sum((x - mean(x))^2) / (length(x)))
}
x1<-provincias$X1
x2<-provincias$X2
x1
x2<-provincias$X2
x3<-provincias$X3
x4<-provincias$X4
x5<-provincias$X5
x6<-provincias$X6
x7<-provincias$X7
x8<-provincias$X8
x9<-provincias$X9
z1 <- (x1 - mean(x1))/sd2(x1)
z2 <- (x2 - mean(x2))/sd2(x2)
z3 <- (x3 - mean(x3))/sd2(x3)
z4 <- (x4 - mean(x4))/sd2(x4)
z5 <- (x5 - mean(x5))/sd2(x5)
z6 <- (x6 - mean(x6))/sd2(x6)
z1 <- (x1 - mean(x1))/sd2(x1)
z2 <- (x2 - mean(x2))/sd2(x2)
z3 <- (x3 - mean(x3))/sd2(x3)
z4 <- (x4 - mean(x4))/sd2(x4)
z5 <- (x5 - mean(x5))/sd2(x5)
z6 <- (x6 - mean(x6))/sd2(x6)
z7 <- (x7 - mean(x7))/sd2(x7)
z8 <- (x8 - mean(x8))/sd2(x8)
z9 <- (x9 - mean(x9))/sd2(x9)
Z <- matrix(c(z1,z2,z3,z4,z5,z6,z7,z8,z9),51,9)
Z
svd(N1.2%*%Z)
eigen(cor(provincias[,-1]))
svd(N1.2%*%Z)$u
svd(N1.2%*%Z)$v #Variables
svd(N1.2%*%Z)$d
l<-svd(N1.2%*%Z)$d #Valores propios
u<-svd(N1.2%*%Z)$u #Indivduos
v<-svd(N1.2%*%Z)$v #Variables
l[1]
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*U[,1]
u
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]
C1
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]  #Componente 1 Relación
PCA.results$ind$coord #Componente 1 función
PCA.results$ind$coord[,1] #Componente 1 función
C1
PCA.results$eig
l
#Construción de Z
sd2 <- function (x) {
sqrt(sum((x - mean(x))^2) / (length(x)))
}
x1<-provincias$X1
x2<-provincias$X2
x3<-provincias$X3
x4<-provincias$X4
x5<-provincias$X5
x6<-provincias$X6
x8<-provincias$X8
x9<-provincias$X9
x7<-provincias$X7
z1 <- (x1 - mean(x1))/sd2(x1)
z2 <- (x2 - mean(x2))/sd2(x2)
z3 <- (x3 - mean(x3))/sd2(x3)
z4 <- (x4 - mean(x4))/sd2(x4)
z5 <- (x5 - mean(x5))/sd2(x5)
z7 <- (x7 - mean(x7))/sd2(x7)
z8 <- (x8 - mean(x8))/sd2(x8)
z6 <- (x6 - mean(x6))/sd2(x6)
z9 <- (x9 - mean(x9))/sd2(x9)
Z <- matrix(c(z1,z2,z3,z4,z5,z6,z7,z8,z9),51,9)
svd(N1.2%*%Z) #Vectores propios
u<-svd(N1.2%*%Z)$u #Indivduos
v<-svd(N1.2%*%Z)$v #Variables
l<-svd(N1.2%*%Z)$d #Valores propios
l
eigen(cor(provincias[,-1]))
svd(N1.2%*%Z%*%t(Z)%*%N1.2) #Vectores propios
N1.2%*%Z%*%t(Z)%*%N1.2
l<-svd(N1.2%*%Z)$d #Valores propios
l
PCA.results$eig
l<-svd(N1.2%*%Z%*%t(Z)%*%N1.2)$d #Valores propios
l
u<-svd(N1.2%*%Z%*%t(Z)%*%N1.2)$u #Indivduos
v<-svd(N1.2%*%Z%*%t(Z)%*%N1.2)$v #Variables
l<-svd(N1.2%*%Z%*%t(Z)%*%N1.2)$d #Valores propios
u
eigen(cor(provincias[,-1])) #Otra forma de calcular vectores propios (cambia algunos signos)
v
u
N1.2%*%Z%*%t(Z)%*%N1.2)
N1.2%*%Z%*%t(Z)%*%N1.2
svd(N1.2%*%Z%*%t(Z)%*%N1.2) #Vectores propios
sqrt(PCA.results$var$contrib[,1])/10 ##Sacar los vectores propios a partir de la funcion pca
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]  #Componente 1 Relación
C1
PCA.results$var$coord[,1]
PCA.results$ind$coord[,1]
svd(N1.2%*%Z) #Vectores propios
sqrt(PCA.results$var$contrib[,1])/10 ##Sacar los vectores propios a partir de la funcion pca
u<-svd(N1.2%*%Z)$u #Indivduos
u
v<-svd(N1.2%*%Z)$v #Variables
v
l<-svd(N1.2%*%Z)$d #Valores propios
l
PCA.results$eig
eigen(cor(provincias[,-1])) #Otra forma de calcular vectores propios (cambia algunos signos)
v<-svd(N1.2%*%Z)$v #Variables
v
#resultados pca
l<-PCA.results$eig
l
#resultados pca
l<-PCA.results$eig[,1]
l
VI<-sqrt(PCA.results$ind$contrib)/10
VI
PCA.results$ind$contrib
u<-svd(N1.2%*%Z)$u #Indivduos
u
VV<-sqrt(PCA.results$var$contrib)/10 #Vectores propios variables
VV
v<-svd(N1.2%*%Z)$v #Variables
v
#resultados pca
lp<-PCA.results$eig[,1] #Valores propios
CI<-PCA.results$ind$coord #Componentes individuos
CV<-PCA.results$var$coord #Componentes variables
VI<-sqrt(PCA.results$ind$contrib)/10 #Vectores propios individuos
VV<-sqrt(PCA.results$var$contrib)/10 #Vectores propios variables
svd(N1.2%*%Z) #Vectores propios
u<-svd(N1.2%*%Z)$u #Indivduos
v<-svd(N1.2%*%Z)$v #Variables
l<-svd(N1.2%*%Z)$d #Valores propios
svd(N1.2%*%Z) #Vectores propios
lp
VV<-sqrt(PCA.results$var$contrib)/10 #Vectores propios variables
VV
eigen(cor(provincias[,-1])) #Otra forma de calcular vectores propios (cambia algunos signos)
PCA.results$var$coord
svd(N1.2%*%Z) #Vectores propios
C11<-sqrt(lp[1])*u[,1]
C11
PCA.results$var$coord[,1]
PCA.results$ind$coord[,1]
C1
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]  #Componente 1 Relación
C11<-sqrt(lp[1])*u[,1]
C1
C11
v<-svd(N1.2%*%Z)$v #Variables
v
svd(N1.2%*%Z) #Vectores propios
eigen(cor(provincias[,-1])) #Otra forma de calcular vectores propios (cambia algunos signos)
#Relaciones de transición
#Individuos
C1<-l[1]*u[,1]  #Componente 1 Relación
C1
C1
l[1]
PCA.results$ind$coord[,1]
u
u[,1]
VI
C1
u
v-svd(N1.2%*%Z)$v#Indivduos
u-svd(N1.2%*%Z)$u#Variables
v<-svd(N1.2%*%Z)$u #Variables
v
u
u<-svd(N1.2%*%Z)$v#Indivduos
u
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]  #Componente 1 Relación
C1
PCA.results$var$coord[,1]
#Relaciones de transición
#Individuos
C1<-l[1]*u[,1]  #Componente 1 Relación
C1
#Relaciones de transición
#Individuos
C1<-l[1]*u[,1]  #Componente 1 Relación
C1
PCA.results$var$coord[,1]
#Relaciones de transición
#Individuos
C1<-sqrt(l[1])*u[,1]  #Componente 1 variables Relación de transición
C1
PCA.results$var$coord[,1] #Componente 1 variables Función PCA
PCA.results$var$coord[,2] #Componente 2 variables Función PCA
PCA.results$ind$coord[,1] #Componente 1 variables Función PCA
#Individuos
C1I<-sqrt(l[1])*N1.2%*%v[,1]  #Componente 1 variables Relación de transición
C1I
#Individuos
C1I<-(l[1])*N1.2%*%v[,1]  #Componente 1 variables Relación de transición
C1I
PCA.results$ind$coord[,1] #Componente 1 variables Función PCA
#Individuos
C1I<-(l[1])*solve(N1.2)%*%v[,1]  #Componente 1 variables Relación de transición
C1I
#Relaciones de transición
#Variables
C1V<-sqrt(l[1])*u[,1]  #Componente 1 variables Relación de transición
C1V
C2V<-sqrt(l[2])*u[,2]  #Componente 2 variables Relación de transición
C2V
PCA.results$var$coord[,2] #Componente 2 variables Función PCA
C2V<-(l[2])*u[,2]  #Componente 2 variables Relación de transición
C2V
C2V<-sqrt(l[2])*u[,2]  #Componente 2 variables Relación de transición
C2V
eigen(N1.2%*%Z)
N1.2%*%Z
svd(N1.2%*%Z) #Vectores propios
var(C1V)
var(PCA.results$var$coord[,1])
PCA.results$eigen
PCA.results$eig
sd2(PCA.results$var$coord[,1])
var(PCA.results$var$coord[,1])
var(PCA.results$ind$coord[,1])
PCA.results$eig
var(PCA.results$var$coord[,1])
sum(var(PCA.results$var$coord))
PCA.results$var$coord
#*****Lab 2
#funciones
#Porcentaje de incercia
library("ade4")
library("FactoMineR")
PCA.results=PCA(provincias[,-1]ncp=9)
PCA.results=PCA(provincias[,-1],ncp=9)
x11()
PCA.results=PCA(provincias[,-1],ncp=9)
PCA.results$eig[2,3]#porcentaje de varianza explicada por los dos primeros ejes
PCA.results$eig
CV<-PCA.results$var$coord #Componentes variables
CI<-PCA.results$ind$coord #Componentes individuos
CI
CV
var(PCA.results$var$coord)
var(PCA.results$var$coord[,1])
for (i in 1:9) {
suma-sum(var(PCA.results$var$coord[,i]))
}
for (i in 1:9) {
suma<-sum(var(PCA.results$var$coord[,i]))
}
suma
sd2(PCA.results$ind$coord[,1])^2
var(PCA.results$ind$coord[,1])
sd2(PCA.results$var$coord[,1])^2
sd2(PCA.results$var$coord[,1])^2
sd2(PCA.results$ind$coord[,1])
l
sd2(PCA.results$var$coord[,1])^2
for (i in 1:9) {
suma<-sum(sd2(PCA.results$var$coord[,i])^2)
}
suma
sd2(PCA.results$ind$coord[,1])^2
sd2(PCA.results$var$coord[,1])^2
sd2(PCA.results$var$coord[,1])^2
sd2(PCA.results$var$coord[,2])^2
sd2(PCA.results$var$coord[,3])^2
sd2(PCA.results$var$coord[,4])^2
sd2(PCA.results$var$coord[,6])^2
sd2(PCA.results$var$coord[,7])^2
sd2(PCA.results$var$coord[,8])^2
sd2(PCA.results$var$coord[,5])^2
sd2(PCA.results$var$coord[,9])^2
c(sd2(PCA.results$var$coord[,1])^2,
sd2(PCA.results$var$coord[,2])^2,
sd2(PCA.results$var$coord[,3])^2,
sd2(PCA.results$var$coord[,4])^2,
sd2(PCA.results$var$coord[,5])^2,
sd2(PCA.results$var$coord[,6])^2,
sd2(PCA.results$var$coord[,7])^2,
sd2(PCA.results$var$coord[,8])^2,
sd2(PCA.results$var$coord[,9])^2)
c(sd2(PCA.results$var$coord[,1])^2,
sd2(PCA.results$var$coord[,2])^2,
sd2(PCA.results$var$coord[,3])^2,
sd2(PCA.results$var$coord[,4])^2,
sd2(PCA.results$var$coord[,5])^2,
sd2(PCA.results$var$coord[,6])^2,
sd2(PCA.results$var$coord[,7])^2,
sd2(PCA.results$var$coord[,8])^2,
sd2(PCA.results$var$coord[,9])^2)
x11()
fviz_pca_biplot(PCA.results)
#3) representacion simultanea
library(factoextra)
x11()
fviz_pca_biplot(PCA.results)
